Feature: Action Winter

  Background:
    Given I am logged in
    Given the API will return
      | 'method' | 'path'                               | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/%7BuserId%7D/actions' |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","type":"simulateur","thematique":"logement","deja_vue":true,"deja_faite":false,"points":30}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"consultation":"tout","realisation":"tout","nombre_resultats":39,"nombre_resultats_disponibles":39} |
    Given The application is launched
    When I tap on the menu button
    When I tap on {'Actions'}

  Scenario: S'incrire par l'adresse et la connexion est √©tablie
    Given the API will return
      | 'method' | 'path'                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers' |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}} |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_adresse'           |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'R√©duisez jusqu‚Äô√† 25% votre facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    Then the API receive
      | 'method' | 'path'                                                  | 'statusCode' | 'requestData'                                                                                                                                       |
      | 'POST'   | "/utilisateurs/{userId}/winter/inscription_par_adresse" |          200 | {'nom':'Saudon',"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","code_commune":"39198"} |
    Then I see {'Connexion √©tablie'}

  Scenario: Remplir l'adresse
    Given the API will return
      | 'method' | 'path'                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers' |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}} |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":null,"longitude":null,"numero_rue":null,"rue":null,"code_postal":"39100","commune":"Dole","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_adresse'           |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'R√©duisez jusqu‚Äô√† 25% votre facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I enter {"110 Rue Garibaldi"} in the autocomplete field
    When I tap on {'110 Rue Garibaldi 69006 Lyon'}
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    Then the API receive
      | 'method' | 'path'                                                  | 'statusCode' | 'requestData'                                                                                                                                    |
      | 'POST'   | "/utilisateurs/{userId}/winter/inscription_par_adresse" |          200 | {'nom':'Saudon',"latitude":45.766368,"longitude":4.850666,"numero_rue":"110","rue":"Rue Garibaldi","code_postal":"69006","code_commune":"69386"} |

  Scenario: S'incrire par l'adresse et la connexion a √©chou√©
    Given the API will return
      | 'method' | 'path'                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers' |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}} |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_adresse'           |          400 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    Then the API receive
      | 'method' | 'path'                                                  | 'statusCode' | 'requestData'                                                                                                                                       |
      | 'POST'   | "/utilisateurs/{userId}/winter/inscription_par_adresse" |          400 | {'nom':'Saudon',"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","code_commune":"39198"} |
    Then I see {'La connexion a √©chou√©'}

  Scenario: S'incrire par le prm et la connexion est √©tablie
    Given the API will return
      | 'method' | 'path'                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers' |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}} |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_prm'               |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'R√©duisez jusqu‚Äô√† 25% votre facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I scroll down to {'Avec mon num√©ro de PRM'}
    When I tap on {'Avec mon num√©ro de PRM'}
    When I enter {'21209261841110'} in the {'Num√©ro de PRM'} field
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    Then the API receive
      | 'method' | 'path'                                              | 'statusCode' | 'requestData'                            |
      | 'POST'   | "/utilisateurs/{userId}/winter/inscription_par_prm" |          200 | {'nom':'Saudon', 'prm':'21209261841110'} |
    Then I see {'Connexion √©tablie'}

  Scenario: Apr√®s que la connexion a √©chou√©, modifier un champ de relancer pas la popup
    Given the API will return
      | 'method' | 'path'                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers' |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}} |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_adresse'           |          400 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    When I tap on {'Retour'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    Then I don't see {'La connexion a √©chou√©'}

  Scenario: Une fois la connexion √©tablie, on voit la premi√®re question
    Given the API will return
      | 'method' | 'path'                                                                                      | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                           |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}} |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                           |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_adresse'                                     |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      | 'GET'    | '/utilisateurs/{userId}/enchainementQuestionsKYC_v2/simulateur_actions_watt_watchers/first' |          200 | {"nombre_total_questions":2,"nombre_total_questions_effectives":2,"position_courante":1,"question_courante":{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":false,"categorie":"test","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"},"is_first":true,"is_last":false,"is_out_of_range":false}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
      | 'GET'    | '/utilisateurs/{userId}/questionsKYC_v2/KYC_alimentation_achat_vrac'                        |          200 | {"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":false,"categorie":"test","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    When I tap on {'Continuer'}
    Then I see {'Achetez-vous en vrac ?'}

  Scenario: Apr√®s avoir r√©pondu √† toutes les questions, on affiche le graphique
    Given the API will return
      | 'method' | 'path'                                                                                                                      | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                                                           |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies sur ma facture d‚Äô√©nergie**","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":false,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                                                           |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      | 'POST'   | '/utilisateurs/{userId}/winter/inscription_par_adresse'                                                                     |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/enchainementQuestionsKYC_v2/simulateur_actions_watt_watchers/first'                                 |          200 | {"nombre_total_questions":2,"nombre_total_questions_effectives":2,"position_courante":1,"question_courante":{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":false,"categorie":"test","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"},"is_first":true,"is_last":false,"is_out_of_range":false}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
      | 'GET'    | '/utilisateurs/{userId}/questionsKYC_v2/KYC_alimentation_achat_vrac'                                                        |          200 | {"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":false,"categorie":"test","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'PUT'    | '/utilisateurs/{userId}/questionsKYC_v2/KYC_alimentation_achat_vrac'                                                        |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/enchainementQuestionsKYC_v2/simulateur_actions_watt_watchers/following/KYC_alimentation_achat_vrac' |          200 | {"nombre_total_questions":2,"nombre_total_questions_effectives":2,"position_courante":2,"question_courante":{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"},"is_first":false,"is_last":true,"is_out_of_range":false}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
      | 'GET'    | '/utilisateurs/{userId}/questionsKYC_v2/KYC_appetence_cuisine'                                                              |          200 | {"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":false,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'PUT'    | '/utilisateurs/{userId}/questionsKYC_v2/KYC_appetence_cuisine'                                                              |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/enchainementQuestionsKYC_v2/simulateur_actions_watt_watchers/following/KYC_appetence_cuisine'       |          200 | {"nombre_total_questions":2,"nombre_total_questions_effectives":2,"position_courante":3,"is_first":false,"is_last":false,"is_out_of_range":true}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | 'GET'    | '/utilisateurs/{userId}/winter/consommation'                                                                                |          200 | {"consommation_totale_euros":1234567,"economies_possibles_euros":3345,"economies_realisees_euros":0,"nombre_actions_associees":0,"detail_usages":[{"eur":130,"percent":15,"type":"airConditioning","couleur":"00809D","emoji":"‚ùÑÔ∏è"},{"eur":1000,"percent":20,"type":"heating","couleur":"F3A26D","emoji":"üî•"},{"eur":453,"percent":10,"type":"appliances","couleur":"FCECDD","emoji":"üì†"},{"eur":200,"percent":7,"type":"cooking","couleur":"FF7601","emoji":"üçï"},{"eur":220,"percent":8,"type":"hotWater","couleur":"FCD8CD","emoji":"üíß"},{"eur":120,"percent":5,"type":"lighting","couleur":"FEEBF6","emoji":"üí°"},{"eur":70,"percent":5,"type":"mobility","couleur":"EBD6FB","emoji":"üöô"},{"eur":42,"percent":10,"type":"multimedia","couleur":"748873","emoji":"üéÆ"},{"eur":987,"percent":15,"type":"other","couleur":"D1A980","emoji":"‚ùì"},{"eur":123,"percent":5,"type":"swimmingPool","couleur":"E5E0D8","emoji":"üèä"}]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/actions?recommandation=recommandee&realisation=pas_faite&selection=actions_watt_watchers'           |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"mettre_couvercle_cuisson","titre":"Je mets un couvercle sur mes casseroles et po√´les pendant la cuisson","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":57,"emoji":"üç≥","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.03516085788},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"regler_temperature_chauffe_eau","titre":"Je r√®gle mon chauffe-eau √† 55¬∞C","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":12,"emoji":"üöø","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.02447339413},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"eteindre_box_internet","titre":"J‚Äô√©teins ma box internet en absence","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":200,"emoji":"üõú","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.00063908099}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"selections":[{"code":"actions_watt_watchers","label":"actions_watt_watchers","selected":true}],"consultation":"tout","realisation":"pas_faite","nombre_resultats":3,"nombre_resultats_disponibles":3} |
      | 'POST'   | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers/faite'                                                     |          200 | {}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    When I scroll down to {'Commencer'}
    When I tap on {'Commencer'}
    When I enter {'Saudon'} in the {'Nom de famille¬†(du titulaire du contrat √©lectrique)'} field
    When I scroll down to {'Valider'}
    When I tap on {'En activant le suivi de ma consommation, je d√©clare sur l‚Äôhonneur √™tre titulaire du compte √©lectrique ou √™tre mandat√© par celui-ci. J‚Äôautorise Watt¬†Watchers √† recueillir mon historique de consommation d‚Äô√©lectricit√© sur 3 ans (demi-heure, journ√©e et puissance maximum quotidienne), ainsi qu‚Äô√† analyser mes consommations.'}
    When I tap on {'Valider'}
    When I tap on {'Continuer'}
    When I scroll down to {'Oui'}
    When I tap on {'Oui'}
    When I scroll down to {'Question suivante'}
    When I tap on {'Question suivante'}
    When I scroll down to {'Oui'}
    When I tap on {'Oui'}
    When I scroll down to {'Question suivante'}
    When I tap on {'Question suivante'}
    Then the API receive
      | 'method' | 'path'                                                                  | 'statusCode' | 'requestData' |
      | 'POST'   | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers/faite' |          200 | null          |
    Then I see {'1234567‚Ç¨'}
    Then I see {'D√©couvrir 3 actions'}

  Scenario: Lorsque l'action a d√©j√† √©t√© faite alors on arrive directement sur la page du graphique
    Given the API will return
      | 'method' | 'path'                                                                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                                                 |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies** sur ma facture d‚Äô√©nergie","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":true},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":true,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":true,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198","est_prm_present":true,"est_prm_obsolete":false,"est_adresse_complete":true}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/winter/consommation'                                                                      |          200 | {"consommation_totale_euros":1234567,"economies_possibles_euros":3345,"economies_realisees_euros":0,"nombre_actions_associees":0,"detail_usages":[{"eur":130,"percent":15,"type":"airConditioning","couleur":"00809D","emoji":"‚ùÑÔ∏è"},{"eur":1000,"percent":20,"type":"heating","couleur":"F3A26D","emoji":"üî•"},{"eur":453,"percent":10,"type":"appliances","couleur":"FCECDD","emoji":"üì†"},{"eur":200,"percent":7,"type":"cooking","couleur":"FF7601","emoji":"üçï"},{"eur":220,"percent":8,"type":"hotWater","couleur":"FCD8CD","emoji":"üíß"},{"eur":120,"percent":5,"type":"lighting","couleur":"FEEBF6","emoji":"üí°"},{"eur":70,"percent":5,"type":"mobility","couleur":"EBD6FB","emoji":"üöô"},{"eur":42,"percent":10,"type":"multimedia","couleur":"748873","emoji":"üéÆ"},{"eur":987,"percent":15,"type":"other","couleur":"D1A980","emoji":"‚ùì"},{"eur":123,"percent":5,"type":"swimmingPool","couleur":"E5E0D8","emoji":"üèä"}]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/actions?recommandation=recommandee&realisation=pas_faite&selection=actions_watt_watchers' |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"mettre_couvercle_cuisson","titre":"Je mets un couvercle sur mes casseroles et po√´les pendant la cuisson","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":57,"emoji":"üç≥","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.03516085788},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"regler_temperature_chauffe_eau","titre":"Je r√®gle mon chauffe-eau √† 55¬∞C","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":12,"emoji":"üöø","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.02447339413},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"eteindre_box_internet","titre":"J‚Äô√©teins ma box internet en absence","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":200,"emoji":"üõú","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.00063908099}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"selections":[{"code":"actions_watt_watchers","label":"actions_watt_watchers","selected":true}],"consultation":"tout","realisation":"pas_faite","nombre_resultats":3,"nombre_resultats_disponibles":3} |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'1234567‚Ç¨'}

  Scenario: Pouvoir recommencer l'action
    Given the API will return
      | 'method' | 'path'                                                                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                                                 |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies** sur ma facture d‚Äô√©nergie","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":true},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":true,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":true,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198","est_prm_present":true,"est_prm_obsolete":false,"est_adresse_complete":true}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      | 'GET'    | '/utilisateurs/{userId}/winter/consommation'                                                                      |          200 | {"consommation_totale_euros":1234567,"economies_possibles_euros":3345,"economies_realisees_euros":0,"nombre_actions_associees":0,"detail_usages":[{"eur":130,"percent":15,"type":"airConditioning","couleur":"00809D","emoji":"‚ùÑÔ∏è"},{"eur":1000,"percent":20,"type":"heating","couleur":"F3A26D","emoji":"üî•"},{"eur":453,"percent":10,"type":"appliances","couleur":"FCECDD","emoji":"üì†"},{"eur":200,"percent":7,"type":"cooking","couleur":"FF7601","emoji":"üçï"},{"eur":220,"percent":8,"type":"hotWater","couleur":"FCD8CD","emoji":"üíß"},{"eur":120,"percent":5,"type":"lighting","couleur":"FEEBF6","emoji":"üí°"},{"eur":70,"percent":5,"type":"mobility","couleur":"EBD6FB","emoji":"üöô"},{"eur":42,"percent":10,"type":"multimedia","couleur":"748873","emoji":"üéÆ"},{"eur":987,"percent":15,"type":"other","couleur":"D1A980","emoji":"‚ùì"},{"eur":123,"percent":5,"type":"swimmingPool","couleur":"E5E0D8","emoji":"üèä"}]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/actions?recommandation=recommandee&realisation=pas_faite&selection=actions_watt_watchers' |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"mettre_couvercle_cuisson","titre":"Je mets un couvercle sur mes casseroles et po√´les pendant la cuisson","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":57,"emoji":"üç≥","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.03516085788},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"regler_temperature_chauffe_eau","titre":"Je r√®gle mon chauffe-eau √† 55¬∞C","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":12,"emoji":"üöø","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.02447339413},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"eteindre_box_internet","titre":"J‚Äô√©teins ma box internet en absence","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":200,"emoji":"üõú","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.00063908099}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"selections":[{"code":"actions_watt_watchers","label":"actions_watt_watchers","selected":true}],"consultation":"tout","realisation":"pas_faite","nombre_resultats":3,"nombre_resultats_disponibles":3} |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'1234567‚Ç¨'}
    When I scroll down to {'Recommencer'}
    When I tap on {'Recommencer'}
    Then I see {'Commencer'}

  Scenario: Si le logement n'a pas de PRM alors on arrive sur la premi√®re page
    Given the API will return
      | 'method' | 'path'                                                                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                                                 |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies** sur ma facture d‚Äô√©nergie","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":true},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":true,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":true,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198","est_prm_present":false,"est_prm_obsolete":false,"est_adresse_complete":true}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
      | 'GET'    | '/utilisateurs/{userId}/winter/consommation'                                                                      |          200 | {"consommation_totale_euros":1234567,"economies_possibles_euros":3345,"economies_realisees_euros":0,"nombre_actions_associees":0,"detail_usages":[{"eur":130,"percent":15,"type":"airConditioning","couleur":"00809D","emoji":"‚ùÑÔ∏è"},{"eur":1000,"percent":20,"type":"heating","couleur":"F3A26D","emoji":"üî•"},{"eur":453,"percent":10,"type":"appliances","couleur":"FCECDD","emoji":"üì†"},{"eur":200,"percent":7,"type":"cooking","couleur":"FF7601","emoji":"üçï"},{"eur":220,"percent":8,"type":"hotWater","couleur":"FCD8CD","emoji":"üíß"},{"eur":120,"percent":5,"type":"lighting","couleur":"FEEBF6","emoji":"üí°"},{"eur":70,"percent":5,"type":"mobility","couleur":"EBD6FB","emoji":"üöô"},{"eur":42,"percent":10,"type":"multimedia","couleur":"748873","emoji":"üéÆ"},{"eur":987,"percent":15,"type":"other","couleur":"D1A980","emoji":"‚ùì"},{"eur":123,"percent":5,"type":"swimmingPool","couleur":"E5E0D8","emoji":"üèä"}]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/actions?recommandation=recommandee&realisation=pas_faite&selection=actions_watt_watchers' |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"mettre_couvercle_cuisson","titre":"Je mets un couvercle sur mes casseroles et po√´les pendant la cuisson","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":57,"emoji":"üç≥","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.03516085788},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"regler_temperature_chauffe_eau","titre":"Je r√®gle mon chauffe-eau √† 55¬∞C","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":12,"emoji":"üöø","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.02447339413},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"eteindre_box_internet","titre":"J‚Äô√©teins ma box internet en absence","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":200,"emoji":"üõú","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.00063908099}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"selections":[{"code":"actions_watt_watchers","label":"actions_watt_watchers","selected":true}],"consultation":"tout","realisation":"pas_faite","nombre_resultats":3,"nombre_resultats_disponibles":3} |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'R√©duisez jusqu‚Äô√† 25% votre facture d‚Äô√©nergie'}

  Scenario: Si le logement a un prm obsol√®te alors on arrive sur la premi√®re page
    Given the API will return
      | 'method' | 'path'                                                                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                                                 |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies** sur ma facture d‚Äô√©nergie","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":true},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":true,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":true,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198","est_prm_present":true,"est_prm_obsolete":true,"est_adresse_complete":true}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
      | 'GET'    | '/utilisateurs/{userId}/winter/consommation'                                                                      |          200 | {"consommation_totale_euros":1234567,"economies_possibles_euros":3345,"economies_realisees_euros":0,"nombre_actions_associees":0,"detail_usages":[{"eur":130,"percent":15,"type":"airConditioning","couleur":"00809D","emoji":"‚ùÑÔ∏è"},{"eur":1000,"percent":20,"type":"heating","couleur":"F3A26D","emoji":"üî•"},{"eur":453,"percent":10,"type":"appliances","couleur":"FCECDD","emoji":"üì†"},{"eur":200,"percent":7,"type":"cooking","couleur":"FF7601","emoji":"üçï"},{"eur":220,"percent":8,"type":"hotWater","couleur":"FCD8CD","emoji":"üíß"},{"eur":120,"percent":5,"type":"lighting","couleur":"FEEBF6","emoji":"üí°"},{"eur":70,"percent":5,"type":"mobility","couleur":"EBD6FB","emoji":"üöô"},{"eur":42,"percent":10,"type":"multimedia","couleur":"748873","emoji":"üéÆ"},{"eur":987,"percent":15,"type":"other","couleur":"D1A980","emoji":"‚ùì"},{"eur":123,"percent":5,"type":"swimmingPool","couleur":"E5E0D8","emoji":"üèä"}]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/actions?recommandation=recommandee&realisation=pas_faite&selection=actions_watt_watchers' |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"mettre_couvercle_cuisson","titre":"Je mets un couvercle sur mes casseroles et po√´les pendant la cuisson","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":57,"emoji":"üç≥","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.03516085788},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"regler_temperature_chauffe_eau","titre":"Je r√®gle mon chauffe-eau √† 55¬∞C","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":12,"emoji":"üöø","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.02447339413},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"eteindre_box_internet","titre":"J‚Äô√©teins ma box internet en absence","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":200,"emoji":"üõú","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.00063908099}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"selections":[{"code":"actions_watt_watchers","label":"actions_watt_watchers","selected":true}],"consultation":"tout","realisation":"pas_faite","nombre_resultats":3,"nombre_resultats_disponibles":3} |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'R√©duisez jusqu‚Äô√† 25% votre facture d‚Äô√©nergie'}

  Scenario: Si le logement a une adresse incompl√®te alors on arrive sur la premi√®re page
    Given the API will return
      | 'method' | 'path'                                                                                                            | 'statusCode' | 'responseData'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | 'GET'    | '/utilisateurs/{userId}/actions/simulateur/actions_watt_watchers'                                                 |          200 | {"nombre_actions_en_cours":1,"nombre_actions_faites":1,"nombre_aides_disponibles":0,"code":"actions_watt_watchers","emoji":"üåßÔ∏è","titre":"**Faire des √©conomies** sur ma facture d‚Äô√©nergie","sous_titre":null,"consigne":"R√©alisez cette action dans les prochaines semaines et partagez vos retours","label_compteur":"**453 actions** r√©alis√©es par la communaut√©","besoins":[],"comment":null,"pourquoi":"## En quelques mots\n\nObtenez la r√©partition de votre consommation d'√©nergie en plus d‚Äôactions personnalis√©es pour r√©duire votre facture d‚Äô√©lectricit√© sans sacrifier votre confort.","type":"simulateur","thematique":"logement","kycs":[{"code":"KYC_alimentation_achat_vrac","question":"Achetez-vous en vrac ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":false},{"code":"non","label":"Non","selected":true},{"code":"ne_sais_pas","label":"Je ne sais pas","selected":false}],"is_answered":true,"categorie":"test","points":5,"type":"choix_unique","is_NGC":true,"thematique":"alimentation"},{"code":"KYC_appetence_cuisine","question":"Aimez-vous cuisiner ?","reponse_multiple":[{"code":"oui","label":"Oui","selected":true},{"code":"parfois","label":"De temps en temps","selected":false},{"code":"non","label":"Non","selected":false},{"code":"pas_de_reponse","label":"Je ne souhaite pas r√©pondre","selected":false}],"is_answered":true,"categorie":"recommandation","points":5,"type":"choix_unique","is_NGC":false,"thematique":"alimentation"}],"quizzes":[],"aides":[],"services":[],"nom_commune":"Lyon","quizz_felicitations":null,"deja_vue":true,"deja_faite":true,"faqs":[],"points":30,"sources":[],"articles":[],"like_level":null,"enchainement_id":"simulateur_actions_watt_watchers","explications_recommandation":{"liste_explications":[],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[]}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/logement'                                                                                 |          200 | {"nombre_adultes":2,"nombre_enfants":1,"latitude":47.10341,"longitude":5.480833,"numero_rue":"5","rue":"Chemin de Rougemont","code_postal":"39100","commune":"DOLE","type":"maison","superficie":"superficie_150","proprietaire":null,"chauffage":null,"plus_de_15_ans":true,"dpe":null,"commune_label":"Dole","code_commune":"39198","est_prm_present":true,"est_prm_obsolete":false,"est_adresse_complete":false}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
      | 'GET'    | '/utilisateurs/{userId}/winter/consommation'                                                                      |          200 | {"consommation_totale_euros":1234567,"economies_possibles_euros":3345,"economies_realisees_euros":0,"nombre_actions_associees":0,"detail_usages":[{"eur":130,"percent":15,"type":"airConditioning","couleur":"00809D","emoji":"‚ùÑÔ∏è"},{"eur":1000,"percent":20,"type":"heating","couleur":"F3A26D","emoji":"üî•"},{"eur":453,"percent":10,"type":"appliances","couleur":"FCECDD","emoji":"üì†"},{"eur":200,"percent":7,"type":"cooking","couleur":"FF7601","emoji":"üçï"},{"eur":220,"percent":8,"type":"hotWater","couleur":"FCD8CD","emoji":"üíß"},{"eur":120,"percent":5,"type":"lighting","couleur":"FEEBF6","emoji":"üí°"},{"eur":70,"percent":5,"type":"mobility","couleur":"EBD6FB","emoji":"üöô"},{"eur":42,"percent":10,"type":"multimedia","couleur":"748873","emoji":"üéÆ"},{"eur":987,"percent":15,"type":"other","couleur":"D1A980","emoji":"‚ùì"},{"eur":123,"percent":5,"type":"swimmingPool","couleur":"E5E0D8","emoji":"üèä"}]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      | 'GET'    | '/utilisateurs/{userId}/actions?recommandation=recommandee&realisation=pas_faite&selection=actions_watt_watchers' |          200 | {"actions":[{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"mettre_couvercle_cuisson","titre":"Je mets un couvercle sur mes casseroles et po√´les pendant la cuisson","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":57,"emoji":"üç≥","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.03516085788},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"regler_temperature_chauffe_eau","titre":"Je r√®gle mon chauffe-eau √† 55¬∞C","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":12,"emoji":"üöø","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.02447339413},{"nombre_actions_en_cours":0,"nombre_actions_faites":0,"nombre_aides_disponibles":0,"code":"eteindre_box_internet","titre":"J‚Äô√©teins ma box internet en absence","sous_titre":null,"type":"classique","thematique":"logement","deja_vue":false,"deja_faite":false,"points":100,"explications_recommandation":{"liste_explications":[{"label_explication":"Recommand√© par Watt Watchers","tag":"recommandation_winter"}],"est_exclu":false},"explications_recommandation_raw":{"liste_explications":[{"inclusion_tag":"recommandation_winter","valeur":10,"ponderation":1}]},"montant_max_economies_euros":200,"emoji":"üõú","label_compteur":"**0 actions** r√©alis√©es par la communaut√©","score_recommandation":100.00063908099}],"filtres":[{"code":"alimentation","label":"ü•¶ Alimentation","selected":false},{"code":"transport","label":"üöó Transports","selected":false},{"code":"logement","label":"üè° Logement","selected":false},{"code":"consommation","label":"üõí Consommation durable","selected":false},{"code":"climat","label":"‚òÄÔ∏è Environnement","selected":false},{"code":"dechet","label":"üóëÔ∏è D√©chets","selected":false},{"code":"loisir","label":"‚öΩ Loisirs","selected":false}],"selections":[{"code":"actions_watt_watchers","label":"actions_watt_watchers","selected":true}],"consultation":"tout","realisation":"pas_faite","nombre_resultats":3,"nombre_resultats_disponibles":3} |
    When I tap on {'üåßÔ∏è¬†Faire des √©conomies sur ma facture d‚Äô√©nergie'}
    Then I see {'R√©duisez jusqu‚Äô√† 25% votre facture d‚Äô√©nergie'}
